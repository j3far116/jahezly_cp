{% extends "layout.twig" %}
{% block title %}طلبات الانضمام{% endblock %}

{% block content %}

<h1 class="h5 mb-3">طلبات الانضمام</h1>

{% if flash('success') %}
<div class="alert alert-success">{{ flash('success') }}</div>
{% endif %}

<div class="card">
  <div class="card-body p-0">

    {% if rows is empty %}
      <div class="p-3 text-center text-muted">لا توجد طلبات حالياً.</div>
    {% else %}
      <div class="table-responsive">
        <table class="table table-striped align-middle mb-0">
          <thead>
            <tr>
              <th>#</th>
              <th>اسم المتجر</th>
              <th>صاحب المتجر</th>
              <th>الهاتف</th>
              <th>المدينة</th>
              <th>التصنيف</th>
              <th>تاريخ الطلب</th>
              <th class="text-end">إجراءات</th>
            </tr>
          </thead>

          <tbody>
            {% for r in rows %}
            <tr>
              <td>{{ r.id }}</td>
              <td>{{ r.store_name }}</td>
              <td>{{ r.owner_name }}</td>
              <td>{{ r.phone }}</td>
              <td>{{ r.city }}</td>
              <td>{{ r.category }}</td>
              <td>{{ r.created_at }}</td>


<td class="text-end">
    {# زر فتح الخرائط #}
    {% if r.lat and r.lng %}
      <a href="https://maps.google.com/?q={{ r.lat }},{{ r.lng }}"
         target="_blank"
         class="btn btn-sm btn-outline-success">
         الموقع
      </a>
    {% endif %}
</td>


              <td class="text-end">
                <a href="/admincp/join-requests/{{ r.id }}" class="btn btn-sm btn-outline-primary">
                  عرض
                </a>

                <a href="/admincp/join-requests/{{ r.id }}/confirm-delete"
                   class="btn btn-sm btn-outline-danger">
                  حذف
                </a>
              </td>

            </tr>
            {% endfor %}
          </tbody>

        </table>
      </div>
    {% endif %}

  </div>
</div>

{% endblock %}
